#include "../includes/main.h"

void	fill_pipe(t_pipe *pipe, t_room *start, t_room *end, float scale)
{
	float	sq[2];
	float	tmp;
	float	dist;

	sq[0] = end->x - start->x;
	sq[1] = end->y - start->y;
	dist = sqrt((sq[0] * sq[0]) + (sq[1] * sq[1]));
	sq[0] /= dist;
	sq[1] /= dist;
//	tmp = sq[0];
//	sq[0] = sq[1];
//	sq[1] = tmp;
	pipe->x_ls = start->x - (sq[1] * scale);
	pipe->y_ls = start->y - (sq[0] * scale);
	pipe->x_le = end->x + (sq[1] * scale);
	pipe->y_le = end->y + (sq[0] * scale);
	pipe->x_rs = start->x + (sq[1] * scale);
	pipe->y_rs = start->y + (sq[0] * scale);
	pipe->x_re = end->x - (sq[1] * scale);
	pipe->y_re = end->y - (sq[0] * scale);
}

int	link_pipes(t_mlx *env)
{
	unsigned int	i;

	i = 0;
	while (i < env->nb_pipes)
	{
		fill_pipe(&env->pipes[i], &env->graph[(int)env->pipes[i].start], &env->graph[(int)env->pipes[i].end], 10);
		ft_fill_pixel(env->img_data, env->pipes[i].x_ls, env->pipes[i].y_ls, 0xff0000);
		ft_fill_pixel(env->img_data, env->pipes[i].x_rs, env->pipes[i].y_rs, 0xff0000);
		ft_fill_pixel(env->img_data, env->pipes[i].x_le, env->pipes[i].y_le, 0xffff00);
		ft_fill_pixel(env->img_data, env->pipes[i].x_re, env->pipes[i].y_re, 0xffff00);
		i++;
	}
	return (0);
}
